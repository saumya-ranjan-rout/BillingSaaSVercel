"use strict";exports.id=5980,exports.ids=[5980],exports.modules={55980:(e,a,t)=>{t.r(a),t.d(a,{UsersDashboard:()=>UsersDashboard});var s=t(20997),n=t(16689),l=t(53817),i=t.n(l),d=t(9618),r=t.n(d),u=t(34892),h=t.n(u),c=t(31595),o=t.n(c),m=t(74699),f=t.n(m),x=t(51876),p=t.n(x),g=t(95775),v=t(15166),j=t.n(v),C=t(92773),b=t.n(C),N=t(22741),S=t.n(N),w=t(1579),y=t.n(w),A=t(76072),U=t.n(A);let UserForm=({open:e,onClose:a,onSubmit:t,user:l,tenants:d})=>{let[r,u]=(0,n.useState)({firstName:"",lastName:"",email:"",role:"user",status:"active",tenant:void 0,password:""});(0,n.useEffect)(()=>{l?u({...l,tenant:l.tenant?{id:l.tenant.id,name:l.tenant.name}:void 0,password:""}):u({firstName:"",lastName:"",email:"",role:"user",status:"active",tenant:void 0,password:""})},[l]);let handleChange=e=>{let{name:a,value:t}=e.target;if("tenantId"===a){let e=d.find(e=>e.id===t);u({...r,tenant:e})}else u({...r,[a]:t})};return(0,s.jsxs)(j(),{open:e,onClose:a,fullWidth:!0,maxWidth:"sm",children:[s.jsx(b(),{children:l?"Edit User":"Add User"}),s.jsx(S(),{children:(0,s.jsxs)(i(),{display:"flex",flexDirection:"column",gap:2,mt:1,children:[s.jsx(y(),{label:"First Name",name:"firstName",value:r.firstName,onChange:handleChange,fullWidth:!0,required:!0}),s.jsx(y(),{label:"Last Name",name:"lastName",value:r.lastName,onChange:handleChange,fullWidth:!0,required:!0}),s.jsx(y(),{label:"Email",name:"email",value:r.email,onChange:handleChange,fullWidth:!0,required:!0}),!l&&s.jsx(y(),{label:"Password",name:"password",type:"password",value:r.password,onChange:handleChange,fullWidth:!0,required:!0}),s.jsx(y(),{select:!0,label:"Tenant",name:"tenantId",value:r.tenant?.id||"",onChange:handleChange,fullWidth:!0,required:!0,children:d.map(e=>s.jsx(U(),{value:e.id,children:e.name},e.id))}),(0,s.jsxs)(y(),{select:!0,label:"Status",name:"status",value:r.status,onChange:handleChange,fullWidth:!0,children:[s.jsx(U(),{value:"active",children:"Active"}),s.jsx(U(),{value:"suspended",children:"Suspended"})]}),(0,s.jsxs)(y(),{select:!0,label:"Role",name:"role",value:r.role,onChange:handleChange,fullWidth:!0,children:[s.jsx(U(),{value:"user",children:"User"}),s.jsx(U(),{value:"admin",children:"Admin"})]}),s.jsx(o(),{variant:"contained",onClick:()=>{if(!r.firstName||!r.lastName||!r.email||!r.role||!r.status||!r.tenant){alert("Please fill all required fields");return}t(r)},children:l?"Update":"Add"})]})})]})};var D=t(52849);let UsersDashboard=()=>{let{get:e,post:a,put:t,patch:l}=(0,g.h)(),[d,u]=(0,n.useState)([]),[c,m]=(0,n.useState)([]),[x,v]=(0,n.useState)(!0),[j,C]=(0,n.useState)(null),[b,N]=(0,n.useState)(!1),[S,w]=(0,n.useState)(null),fetchData=async()=>{v(!0);try{let a=await e("/api/super-admin/users"),t=await e("/api/super-admin/tenants");u(a.data||[]),m(t.data||[]),C(null)}catch(e){C(e.message||"Failed to fetch data")}finally{v(!1)}};(0,n.useEffect)(()=>{fetchData()},[]);let handleEdit=e=>{w(e),N(!0)},handleSubmit=async e=>{try{S?await t(`/api/super-admin/users/${S.id}`,e):await a("/api/super-admin/users",e),N(!1),fetchData()}catch(e){alert(e.message||"Failed to save user")}},handleStatusChange=async e=>{try{await l(`/api/super-admin/users/${e.id}/status`,{isActive:"active"!==e.status}),fetchData()}catch(e){alert(e.message||"Failed to change status")}};return(0,s.jsxs)(i(),{component:r(),sx:{p:3,borderRadius:2},children:[(0,s.jsxs)(i(),{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3,children:[s.jsx(h(),{variant:"h6",children:"Users Management"}),s.jsx(o(),{variant:"contained",onClick:()=>{w(null),N(!0)},children:"Add User"})]}),x&&(0,s.jsxs)(i(),{textAlign:"center",py:5,children:[s.jsx(f(),{}),s.jsx(h(),{mt:2,children:"Loading..."})]}),j&&s.jsx(p(),{severity:"error",children:j}),!x&&d.length>0&&s.jsx(D.w,{title:"Users",resource:"users",data:d,columns:[{id:"firstName",label:"First Name"},{id:"lastName",label:"Last Name"},{id:"email",label:"Email"},{id:"role",label:"Role"},{id:"tenant",label:"Tenant",format:e=>e.tenant?.name||"-"},{id:"status",label:"Status",format:e=>"active"===e.status?"Active":"Inactive"},{id:"createdAt",label:"Created At",format:e=>e.createdAt?new Date(e.createdAt).toLocaleDateString():"-"}],onEdit:e=>{let a=d.find(a=>a.id===e);a&&handleEdit(a)},onStatusChange:e=>{let a=d.find(a=>a.id===e);a&&handleStatusChange(a)}}),!x&&0===d.length&&s.jsx(h(),{children:"No users found."}),s.jsx(UserForm,{open:b,onClose:()=>N(!1),onSubmit:handleSubmit,user:S,tenants:c})]})}}};