"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8599],{98599:function(e,a,s){s.r(a),s.d(a,{ProfessionalsDashboard:function(){return ProfessionalsDashboard}});var n=s(52322),l=s(2784),i=s(69692),t=s(35744),r=s(62197),o=s(8204),d=s(72841),c=s(12352),u=s(95775),h=s(69089),m=s(35936),f=s(6060),p=s(45596),v=s(425),g=s(52616),x=s(38738);let ProfessionalForm=e=>{let{open:a,onClose:s,onSubmit:t,professional:r}=e,[d,c]=(0,l.useState)({email:"",password:"",firstName:"",lastName:"",professionalType:"chartered_accountant",firmName:"",professionalLicenseNumber:"",address:"",phone:"",isActive:!0,tenants:[],permissions:{canFileGST:!1,canViewAllInvoices:!1,canManageVendors:!1,canApproveInvoices:!1,canAccessReports:!1,canManageUsers:!1}});(0,l.useEffect)(()=>{r?c(r):c({email:"",password:"",firstName:"",lastName:"",professionalType:"chartered_accountant",firmName:"",professionalLicenseNumber:"",address:"",phone:"",isActive:!0,tenants:[],permissions:{canFileGST:!1,canViewAllInvoices:!1,canManageVendors:!1,canApproveInvoices:!1,canAccessReports:!1,canManageUsers:!1}})},[r]);let handleChange=e=>{c({...d,[e.target.name]:e.target.value})};return(0,n.jsxs)(h.Z,{open:a,onClose:s,fullWidth:!0,maxWidth:"sm",children:[(0,n.jsx)(m.Z,{children:r?"Edit Professional":"Add Professional"}),(0,n.jsx)(f.Z,{children:(0,n.jsxs)(i.Z,{display:"flex",flexDirection:"column",gap:2,mt:1,children:[(0,n.jsx)(p.Z,{label:"Email",name:"email",value:d.email,onChange:handleChange,required:!0,fullWidth:!0}),!r&&(0,n.jsx)(p.Z,{label:"Password",name:"password",type:"password",value:d.password,onChange:handleChange,required:!0,fullWidth:!0}),(0,n.jsx)(p.Z,{label:"First Name",name:"firstName",value:d.firstName,onChange:handleChange,required:!0,fullWidth:!0}),(0,n.jsx)(p.Z,{label:"Last Name",name:"lastName",value:d.lastName,onChange:handleChange,required:!0,fullWidth:!0}),(0,n.jsxs)(p.Z,{select:!0,label:"Professional Type",name:"professionalType",value:d.professionalType,onChange:handleChange,fullWidth:!0,children:[(0,n.jsx)(v.Z,{value:"ca",children:"Chartered Accountant"}),(0,n.jsx)(v.Z,{value:"accountant",children:"Accountant"}),(0,n.jsx)(v.Z,{value:"consultant",children:"Tax Consultant"}),(0,n.jsx)(v.Z,{value:"other",children:"Other"})]}),(0,n.jsx)(p.Z,{label:"Firm Name",name:"firmName",value:d.firmName||"",onChange:handleChange,fullWidth:!0}),(0,n.jsx)(p.Z,{label:"License Number",name:"professionalLicenseNumber",value:d.professionalLicenseNumber||"",onChange:handleChange,fullWidth:!0}),(0,n.jsx)(p.Z,{label:"Phone",name:"phone",value:d.phone||"",onChange:handleChange,fullWidth:!0}),(0,n.jsx)(p.Z,{label:"Address",name:"address",value:d.address||"",onChange:handleChange,fullWidth:!0}),(0,n.jsx)(g.Z,{control:(0,n.jsx)(x.Z,{checked:d.isActive,onChange:e=>c({...d,isActive:e.target.checked})}),label:"Active"}),(0,n.jsx)(o.Z,{variant:"contained",onClick:()=>{if(!d.email||!d.firstName||!d.lastName){alert("Email, First Name, and Last Name are required");return}t(d)},children:r?"Update Professional":"Add Professional"})]})})]})};var N=s(56958),b=s(52849);let ProfessionalsDashboard=()=>{let{get:e,post:a,put:s,patch:h}=(0,u.h)(),[m,f]=(0,l.useState)([]),[p,v]=(0,l.useState)(!0),[g,x]=(0,l.useState)(null),[C,j]=(0,l.useState)(!1),[Z,A]=(0,l.useState)(null),fetchProfessionals=async()=>{v(!0);try{let a=await e("/api/super-admin/professionals");f(a.data||[])}catch(e){x(e.message||"Failed to fetch professionals")}finally{v(!1)}};(0,l.useEffect)(()=>{fetchProfessionals()},[]);let handleEdit=e=>{var a,s,n;let l={...e,email:(null===(a=e.user)||void 0===a?void 0:a.email)||"",firstName:(null===(s=e.user)||void 0===s?void 0:s.firstName)||"",lastName:(null===(n=e.user)||void 0===n?void 0:n.lastName)||""};A(l),j(!0)},handleStatusChange=async e=>{try{let a=!e.isActive;await h("/api/super-admin/professionals/".concat(e.id,"/").concat(e.userId,"/status"),{isActive:a}),N.Am.success("Status updated successfully"),fetchProfessionals()}catch(e){alert(e.message||"Failed to change status")}},handleSubmit=async e=>{try{Z?(await s("/api/super-admin/professionals/".concat(Z.id),e),N.Am.success("Professional user updated successfully")):(await a("/api/super-admin/professionals",e),N.Am.success("Professional user created successfully")),j(!1),fetchProfessionals()}catch(e){alert(e.message||"Failed to save professional")}};return(0,n.jsxs)(i.Z,{component:t.Z,sx:{p:3,borderRadius:2},children:[(0,n.jsxs)(i.Z,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3,children:[(0,n.jsx)(r.Z,{variant:"h6",children:"Professionals Management"}),(0,n.jsx)(o.Z,{variant:"contained",onClick:()=>{A(null),j(!0)},children:"Add Professional"})]}),p&&(0,n.jsxs)(i.Z,{textAlign:"center",py:5,children:[(0,n.jsx)(d.Z,{}),(0,n.jsx)(r.Z,{mt:2,children:"Loading professionals..."})]}),g&&(0,n.jsx)(c.Z,{severity:"error",children:g}),!p&&m.length>0&&(0,n.jsx)(b.w,{title:"Professionals",resource:"professionals",data:m,columns:[{id:"firstName",label:"First Name"},{id:"lastName",label:"Last Name"},{id:"email",label:"Email"},{id:"firmName",label:"Firm Name"},{id:"professionalType",label:"Type"},{id:"isActive",label:"Status",format:e=>e.isActive?"Active":"Inactive"}],onEdit:e=>{let a=m.find(a=>a.id===e);a&&handleEdit(a)},onStatusChange:e=>{let a=m.find(a=>a.id===e);a&&handleStatusChange(a)}}),(0,n.jsx)(ProfessionalForm,{open:C,onClose:()=>j(!1),onSubmit:handleSubmit,professional:Z})]})}}}]);