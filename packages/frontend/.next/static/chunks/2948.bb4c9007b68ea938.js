"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2948],{52948:function(e,a,n){n.r(a),n.d(a,{TenantsDashboard:function(){return TenantsDashboard}});var t=n(52322),s=n(2784),i=n(69692),l=n(35744),d=n(62197),u=n(8204),c=n(72841),r=n(12352),h=n(95775),m=n(69089),o=n(35936),b=n(6060),f=n(45596);let TenantForm=e=>{let{open:a,onClose:n,onSubmit:l,tenant:d}=e,[c,r]=(0,s.useState)({name:"",businessName:"",subdomain:"",slug:"",isActive:!0});(0,s.useEffect)(()=>{d?r(d):r({name:"",businessName:"",subdomain:"",slug:"",isActive:!0})},[d]);let handleChange=e=>{r({...c,[e.target.name]:e.target.value})};return(0,t.jsxs)(m.Z,{open:a,onClose:n,fullWidth:!0,maxWidth:"sm",children:[(0,t.jsx)(o.Z,{children:d?"Edit Tenant":"Add Tenant"}),(0,t.jsx)(b.Z,{children:(0,t.jsxs)(i.Z,{display:"flex",flexDirection:"column",gap:2,mt:1,children:[(0,t.jsx)(f.Z,{label:"Tenant Name",name:"name",value:c.name,onChange:handleChange,required:!0,fullWidth:!0}),(0,t.jsx)(f.Z,{label:"Business Name",name:"businessName",value:c.businessName,onChange:handleChange,fullWidth:!0}),(0,t.jsx)(f.Z,{label:"Subdomain",name:"subdomain",value:c.subdomain,onChange:handleChange,required:!0,fullWidth:!0}),(0,t.jsx)(f.Z,{label:"Slug",name:"slug",value:c.slug||"",onChange:handleChange,fullWidth:!0}),(0,t.jsx)(u.Z,{variant:"contained",onClick:()=>{if(!c.name||!c.subdomain){alert("Name and Subdomain are required");return}l(c)},children:d?"Update Tenant":"Add Tenant"})]})})]})};var g=n(56958),x=n(52849);let TenantsDashboard=()=>{let{get:e,post:a,put:n,patch:m}=(0,h.h)(),[o,b]=(0,s.useState)([]),[f,p]=(0,s.useState)(!0),[j,v]=(0,s.useState)(null),[C,T]=(0,s.useState)(!1),[Z,S]=(0,s.useState)(null),fetchTenants=async()=>{p(!0);try{let a=await e("/api/super-admin/tenants");b(a.data||[])}catch(e){v(e.message||"Failed to fetch tenants")}finally{p(!1)}};(0,s.useEffect)(()=>{fetchTenants()},[]);let handleEdit=e=>{S(e),T(!0)},handleStatusChange=async e=>{try{await m("/api/super-admin/tenants/".concat(e.id,"/status"),{isActive:!e.isActive}),fetchTenants()}catch(e){alert(e.message||"Failed to change status")}},handleSubmit=async e=>{try{Z?(await n("/api/super-admin/tenants/".concat(Z.id),e),g.Am.success("Tenant updated successfully")):(await a("/api/super-admin/tenants",e),g.Am.success("Tenant created successfully")),T(!1),fetchTenants()}catch(e){alert(e.message||"Failed to save tenant")}};return(0,t.jsxs)(i.Z,{component:l.Z,sx:{p:3,borderRadius:2},children:[(0,t.jsxs)(i.Z,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3,children:[(0,t.jsx)(d.Z,{variant:"h6",children:"Tenants Management"}),(0,t.jsx)(u.Z,{variant:"contained",onClick:()=>{S(null),T(!0)},children:"Add Tenant"})]}),f&&(0,t.jsxs)(i.Z,{textAlign:"center",py:5,children:[(0,t.jsx)(c.Z,{}),(0,t.jsx)(d.Z,{mt:2,children:"Loading tenants..."})]}),j&&(0,t.jsx)(r.Z,{severity:"error",children:j}),!f&&o.length>0&&(0,t.jsx)(x.w,{title:"Tenants",resource:"tenants",data:o,columns:[{id:"name",label:"Tenant Name"},{id:"businessName",label:"Business Name"},{id:"subdomain",label:"Subdomain"},{id:"isActive",label:"Status",format:e=>e.isActive?"Active":"Inactive"},{id:"createdAt",label:"Created At",format:e=>e.createdAt?new Date(e.createdAt).toLocaleDateString():"-"}],onEdit:e=>{let a=o.find(a=>a.id===e);a&&handleEdit(a)},onStatusChange:e=>{let a=o.find(a=>a.id===e);a&&handleStatusChange(a)}}),!f&&0===o.length&&(0,t.jsx)(d.Z,{children:"No tenants found."}),(0,t.jsx)(TenantForm,{open:C,onClose:()=>T(!1),onSubmit:handleSubmit,tenant:Z})]})}}}]);